clear
str = '/home/jason/disorder/pcbm/pcbm_pdb/isolated/';

x0.start = m_x0_read([str 'p1d1_1a1b1c.isolated.data']);

x0.bond = m_xyz_read([str 'gulp.xyz']);

olps = m_pcbm_olps;

[I.CF J.CF] = find( x0.start.m==olps.type.CF);
[I.CA1 J.CA1] = find( x0.start.m==olps.type.CA1);
[I.CA2 J.CA2] = find( x0.start.m==olps.type.CA2);
[I.C J.C] = find( x0.start.m==olps.type.C);
[I.CT1 J.CT1] = find( x0.start.m==olps.type.CT1);
[I.CT2 J.CT2] = find( x0.start.m==olps.type.CT2);
[I.CT3 J.CT3] = find( x0.start.m==olps.type.CT3);
[I.O J.O] = find( x0.start.m==olps.type.O);
[I.OS J.OS] = find( x0.start.m==olps.type.OS);
[I.HA J.HA] = find( x0.start.m==olps.type.HA);
[I.HC J.HC] = find( x0.start.m==olps.type.HC);

%full
plot3(...
    x0.start.x(:),x0.start.y(:),x0.start.z(:),'.',...
    x0.bond.x(:),x0.bond.y(:),x0.bond.z(:),'.'...
    )
pause
%c60
plot3(...
    x0.start.x(:),x0.start.y(:),x0.start.z(:),'.',...
    x0.start.x(I.CF),x0.start.y(I.CF),x0.start.z(I.CF),'.',...
    x0.bond.x(I.CF),x0.bond.y(I.CF),x0.bond.z(I.CF),'.'...
    )
pause
clf
plot3(...
    x0.start.x(:),x0.start.y(:),x0.start.z(:),'.',...
    x0.start.x(I.CA1),x0.start.y(I.CA1),x0.start.z(I.CA1),'.'...
    )
hold on
plot3(...
    x0.bond.x(I.CA1),x0.bond.y(I.CA1),x0.bond.z(I.CA1),'o','MarkerSize',30 ...
    )
pause
clf
plot3(...
    x0.start.x(:),x0.start.y(:),x0.start.z(:),'.',...
    x0.start.x(I.CA2),x0.start.y(I.CA2),x0.start.z(I.CA2),'.',...
    x0.bond.x(I.CA2),x0.bond.y(I.CA2),x0.bond.z(I.CA2),'.'...
    )
hold on
plot3(...
    x0.bond.x(I.CA2),x0.bond.y(I.CA2),x0.bond.z(I.CA2),'o','MarkerSize',30 ...
    )
pause
clf
plot3(...
    x0.start.x(:),x0.start.y(:),x0.start.z(:),'.',...
    x0.start.x(I.C),x0.start.y(I.C),x0.start.z(I.C),'.',...
    x0.bond.x(I.C),x0.bond.y(I.C),x0.bond.z(I.C),'.'...
    )
hold on
plot3(...
    x0.bond.x(I.C),x0.bond.y(I.C),x0.bond.z(I.C),'o','MarkerSize',30 ...
    )
pause
clf
plot3(...
    x0.start.x(:),x0.start.y(:),x0.start.z(:),'.',...
    x0.start.x(I.CT1),x0.start.y(I.CT1),x0.start.z(I.CT1),'.',...
    x0.bond.x(I.CT1),x0.bond.y(I.CT1),x0.bond.z(I.CT1),'.'...
    )
hold on
plot3(...
    x0.bond.x(I.CT1),x0.bond.y(I.CT1),x0.bond.z(I.CT1),'o','MarkerSize',30 ...
    )
I.CT1
pause
clf
plot3(...
    x0.start.x(:),x0.start.y(:),x0.start.z(:),'.',...
    x0.start.x(I.CT2),x0.start.y(I.CT2),x0.start.z(I.CT2),'.',...
    x0.bond.x(I.CT2),x0.bond.y(I.CT2),x0.bond.z(I.CT2),'.'...
    )
hold on
plot3(...
    x0.bond.x(I.CT2),x0.bond.y(I.CT2),x0.bond.z(I.CT2),'o','MarkerSize',30 ...
    )
pause
clf
plot3(...
    x0.start.x(:),x0.start.y(:),x0.start.z(:),'.',...
    x0.start.x(I.CT3),x0.start.y(I.CT3),x0.start.z(I.CT3),'.',...
    x0.bond.x(I.CT3),x0.bond.y(I.CT3),x0.bond.z(I.CT3),'.'...
    )
hold on
plot3(...
    x0.bond.x(I.CT3),x0.bond.y(I.CT3),x0.bond.z(I.CT3),'o','MarkerSize',30 ...
    )
pause
clf
plot3(...
    x0.start.x(:),x0.start.y(:),x0.start.z(:),'.',...
    x0.start.x(I.O),x0.start.y(I.O),x0.start.z(I.O),'.',...
    x0.bond.x(I.O),x0.bond.y(I.O),x0.bond.z(I.O),'.'...
    )
hold on
plot3(...
    x0.bond.x(I.O),x0.bond.y(I.O),x0.bond.z(I.O),'o','MarkerSize',30 ...
    )
pause
clf
plot3(...
    x0.start.x(:),x0.start.y(:),x0.start.z(:),'.',...
    x0.start.x(I.OS),x0.start.y(I.OS),x0.start.z(I.OS),'.',...
    x0.bond.x(I.OS),x0.bond.y(I.OS),x0.bond.z(I.OS),'.'...
    )
hold on
plot3(...
    x0.bond.x(I.OS),x0.bond.y(I.OS),x0.bond.z(I.OS),'o','MarkerSize',30 ...
    )
pause
clf
plot3(...
    x0.start.x(:),x0.start.y(:),x0.start.z(:),'.',...
    x0.start.x(I.HA),x0.start.y(I.HA),x0.start.z(I.HA),'.',...
    x0.bond.x(I.HA),x0.bond.y(I.HA),x0.bond.z(I.HA),'.'...
    )
hold on
plot3(...
    x0.bond.x(I.HA),x0.bond.y(I.HA),x0.bond.z(I.HA),'o','MarkerSize',30 ...
    )
pause
clf
plot3(...
    x0.start.x(:),x0.start.y(:),x0.start.z(:),'.',...
    x0.start.x(I.HC),x0.start.y(I.HC),x0.start.z(I.HC),'.',...
    x0.bond.x(I.HC),x0.bond.y(I.HC),x0.bond.z(I.HC),'.'...
    )
hold on
plot3(...
    x0.bond.x(I.HC),x0.bond.y(I.HC),x0.bond.z(I.HC),'o','MarkerSize',30 ...
    )



