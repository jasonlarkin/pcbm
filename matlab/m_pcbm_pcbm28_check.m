clear

%--------------------------------------------------------------------------
%x
%--------------------------------------------------------------------------
x=[       1       1       1   -0.030000   51.965000   52.024000   56.696000
2       1       2    0.000000   52.188228   50.813639   57.570748
3       1       3   -0.115000   51.711042   50.803255   58.887003
4       1       3   -0.115000   51.917918   49.680686   59.697657
5       1       3   -0.115000   52.602983   48.569145   59.192449
6       1       3   -0.115000   53.081344   48.580230   57.876754
7       1       4   -0.500000   53.683035   54.708120   54.317823
8       1       5   -0.170000   55.718201   54.604413   53.319474
9       1       3   -0.115000   52.873998   49.702415   57.065846
10       1       6   -0.120000   53.239878   52.570251   56.052317
11       1       6   -0.120000   53.456402   52.006851   54.647340
12       1       6   -0.120000   54.721827   52.568446   53.998161
13       1       7    0.700000   54.648282   54.073123   53.896798
14       1       8   -0.180000   55.738660   56.007531   53.181585
15       1       9    0.115000   51.183166   51.660808   59.277405
16       1       9    0.115000   51.549855   49.671845   60.713065
17       1       9    0.115000   52.763313   47.703151   59.817758
18       1       9    0.115000   53.610753   47.723068   57.487090
19       1       9    0.115000   53.243908   49.710300   56.050994
20       1      10    0.060000   53.186047   53.657833   56.004253
21       1      10    0.060000   54.098310   52.327083   56.678576
22       1      10    0.060000   52.593982   52.241262   54.023384
23       1      10    0.060000   53.523207   50.919890   54.694992
24       1      10    0.060000   55.600558   52.294834   54.582253
25       1      10    0.060000   54.853825   52.150184   53.000226
26       1      10    0.060000   54.895172   56.340692   52.576986
27       1      10    0.060000   55.677329   56.484967   54.159501
28       1      10    0.060000   56.661502   56.325622   52.696439];


%--------------------------------------------------------------------------
%harm
%--------------------------------------------------------------------------
harm=...
    [     1     1     4     3
     2     1     5     4
     3     1     6     5
     4     1     9     6
     5     2     3     2
     6     2     9     2
     7     3     2     1
     8     4    15     3
     9     4    16     4
    10     4    17     5
    11     4    18     6
    12     4    19     9
    13     5    10     1
    14     6    11    10
    15     6    12    11
    16     7    13    12
    17     8    14     8
    18     9    20    10
    19     9    21    10
    20     9    22    11
    21     9    23    11
    22     9    24    12
    23     9    25    12
    24    10    26    14
    25    10    27    14
    26    10    28    14
    27    11    13     7
    28    12    13     8];

for icnt = 1:length(harm)
plot3(...
    x(1:14,5),x(1:14,6),x(1:14,7),'.',...
    x(15:28,5),x(15:28,6),x(15:28,7),'*',...
    x(harm(icnt,3),5),x(harm(icnt,3),6),x(harm(icnt,3),7),'o',...
    x(harm(icnt,4),5),x(harm(icnt,4),6),x(harm(icnt,4),7),'o')
icnt
pause
end

%--------------------------------------------------------------------------
%angle
%--------------------------------------------------------------------------
angle=...
    [     1     1     3     4     5
     2     1     4     5     6
     3     1     5     6     9
     4     2     3     2     9
     5     3     2     3     4
     6     3     2     9     6
     7     4     1     2     3
     8     4     1     2     9
     9     5     4     3    15
    10     5     3     4    16
    11     5     5     4    16
    12     5     4     5    17
    13     5     6     5    17
    14     5     5     6    18
    15     5     9     6    18
    16     5     6     9    19
    17     6     2     3    15
    18     6     2     9    19
    19     7     1    10    11
    20     8    10    11    12
    21     9     2     1    10
    22    10    11    12    13
    23    11     1    10    20
    24    11     1    10    21
    25    12    11    10    20
    26    12    11    10    21
    27    12    10    11    22
    28    12    10    11    23
    29    12    12    11    22
    30    12    12    11    23
    31    12    11    12    24
    32    12    11    12    25
    33    13    13    12    24
    34    13    13    12    25
    35    14     8    14    26
    36    14     8    14    27
    37    14     8    14    28
    38    15    20    10    21
    39    15    22    11    23
    40    15    24    12    25
    41    16    26    14    27
    42    16    26    14    28
    43    16    27    14    28
    44    17     8    13    12
    45    18     7    13    12
    46    19     7    13     8
    47    20    13     8    14];

for icnt=1:length(angle)
clf
plot3(...
    x(1:14,5),x(1:14,6),x(1:14,7),'.',...
    x(15:28,5),x(15:28,6),x(15:28,7),'*'...
    )
hold on
plot3(...
    x(angle(icnt,3),5),x(angle(icnt,3),6),x(angle(icnt,3),7),'o',...
    x(angle(icnt,4),5),x(angle(icnt,4),6),x(angle(icnt,4),7),'o',...
    x(angle(icnt,5),5),x(angle(icnt,5),6),x(angle(icnt,5),7),'o'...
    )
icnt
pause
end

dihedral=...
    [       1       1      15       3       4      16
       2       1      16       4       5      17
       3       1      17       5       6      18
       4       1      18       6       9      19
       1       2      15       3       4       5
       2       2       3       4       5      17
       3       2      16       4       5       6
       4       2       4       5       6      18
       5       2      17       5       6       9
       6       2       5       6       9      19
       1       3       2       3       4      16
       2       3      18       6       9       2
       1       4       1       2       3      15
       2       4       1       2       9      19
       1       5       1      10      11      12
       1       6       1      10      11      12
       1       7       1      10      11      12
       1       8      20      10      11      12
       2       8      21      10      11      12
       3       8      10      11      12      24
       4       8      10      11      12      25
       1       9       1      10      11      22
       2       9       1      10      11      23
       1      10      20      10      11      22
       2      10      20      10      11      23
       3      10      21      10      11      22
       4      10      21      10      11      23
       5      10      22      11      12      24
       6      10      22      11      12      25
       7      10      23      11      12      24
       8      10      23      11      12      25
       1      11      11      12      13       7
       1      12      11      12      13       7
       1      13      11      12      13       7
       1      14      11      12      13       8
       1      15      24      12      13       8
       2      15      25      12      13       8
       1      16      14       8      13      12
       1      17      14       8      13      12
       1      18      14       8      13       7
       1      19      13       8      14      26
       2      19      13       8      14      27
       3      19      13       8      14      28];

for icnt=1:length(angle)
clf
plot3(...
    x(1:14,5),x(1:14,6),x(1:14,7),'.',...
    x(15:28,5),x(15:28,6),x(15:28,7),'*'...
    )
hold on
plot3(...
    x(dihedral(icnt,3),5),x(dihedral(icnt,3),6),x(dihedral(icnt,3),7),'o',...
    x(dihedral(icnt,4),5),x(dihedral(icnt,4),6),x(dihedral(icnt,4),7),'o',...
    x(dihedral(icnt,5),5),x(dihedral(icnt,5),6),x(dihedral(icnt,5),7),'o',...
    x(dihedral(icnt,6),5),x(dihedral(icnt,6),6),x(dihedral(icnt,6),7),'o'...
    )
icnt
pause
end

[(1:length(dihedral))' dihedral(:,2:end)]

