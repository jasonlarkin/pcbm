clear

x.p1d1_1a1b1c =...
    m_x0_read('/home/jason/disorder/pcbm/pcbm_pdb/p1d1_1a1b1c/p1d1_1a1b1c.matlab');

plot3(x.p1d1_1a1b1c.x,x.p1d1_1a1b1c.y,x.p1d1_1a1b1c.z,'.')

x.p1d1_1a1b1c.NUM_UNITS = 4; 
x.p1d1_1a1b1c.NUM_ATOMS_UNIT = x.p1d1_1a1b1c.NUM_ATOMS/x.p1d1_1a1b1c.NUM_UNITS; 

type.CF = 1; type.CA1 = 2; type.CA2 = 3; type.C = 4; 
type.CT1 = 5; type.CT2 = 6; type.CT3 = 7;

type.O = 8; type.OS = 9;

type.HA = 10; type.HC = 11; type.Cl = 12;

% for iunit = 1:x.p1d1_1a1b1c.NUM_UNITS
%     plot3(...
%         x.p1d1_1a1b1c.x((iunit-1)*x.p1d1_1a1b1c.NUM_ATOMS_UNIT+1:...
%         (iunit)*x.p1d1_1a1b1c.NUM_ATOMS_UNIT),...
%         x.p1d1_1a1b1c.y((iunit-1)*x.p1d1_1a1b1c.NUM_ATOMS_UNIT+1:...
%         (iunit)*x.p1d1_1a1b1c.NUM_ATOMS_UNIT),...
%         x.p1d1_1a1b1c.z((iunit-1)*x.p1d1_1a1b1c.NUM_ATOMS_UNIT+1:...
%         (iunit)*x.p1d1_1a1b1c.NUM_ATOMS_UNIT),'.')
%     pause
% end

%initial
%     plot3(...
%         x.p1d1_1a1b1c.x((1-1)*x.p1d1_1a1b1c.NUM_ATOMS_UNIT+1:...
%         (1)*x.p1d1_1a1b1c.NUM_ATOMS_UNIT),...
%         x.p1d1_1a1b1c.y((1-1)*x.p1d1_1a1b1c.NUM_ATOMS_UNIT+1:...
%         (1)*x.p1d1_1a1b1c.NUM_ATOMS_UNIT),...
%         x.p1d1_1a1b1c.z((1-1)*x.p1d1_1a1b1c.NUM_ATOMS_UNIT+1:...
%         (1)*x.p1d1_1a1b1c.NUM_ATOMS_UNIT),'.',...
%         x.p1d1_1a1b1c.x((2-1)*x.p1d1_1a1b1c.NUM_ATOMS_UNIT+1:...
%         (2)*x.p1d1_1a1b1c.NUM_ATOMS_UNIT),...
%         x.p1d1_1a1b1c.y((2-1)*x.p1d1_1a1b1c.NUM_ATOMS_UNIT+1:...
%         (2)*x.p1d1_1a1b1c.NUM_ATOMS_UNIT),...
%         x.p1d1_1a1b1c.z((2-1)*x.p1d1_1a1b1c.NUM_ATOMS_UNIT+1:...
%         (2)*x.p1d1_1a1b1c.NUM_ATOMS_UNIT),'.',...
%         x.p1d1_1a1b1c.x((3-1)*x.p1d1_1a1b1c.NUM_ATOMS_UNIT+1:...
%         (3)*x.p1d1_1a1b1c.NUM_ATOMS_UNIT),...
%         x.p1d1_1a1b1c.y((3-1)*x.p1d1_1a1b1c.NUM_ATOMS_UNIT+1:...
%         (3)*x.p1d1_1a1b1c.NUM_ATOMS_UNIT),...
%         x.p1d1_1a1b1c.z((3-1)*x.p1d1_1a1b1c.NUM_ATOMS_UNIT+1:...
%         (3)*x.p1d1_1a1b1c.NUM_ATOMS_UNIT),'.',...
%         x.p1d1_1a1b1c.x((4-1)*x.p1d1_1a1b1c.NUM_ATOMS_UNIT+1:...
%         (4)*x.p1d1_1a1b1c.NUM_ATOMS_UNIT),...
%         x.p1d1_1a1b1c.y((4-1)*x.p1d1_1a1b1c.NUM_ATOMS_UNIT+1:...
%         (4)*x.p1d1_1a1b1c.NUM_ATOMS_UNIT),...
%         x.p1d1_1a1b1c.z((4-1)*x.p1d1_1a1b1c.NUM_ATOMS_UNIT+1:...
%         (4)*x.p1d1_1a1b1c.NUM_ATOMS_UNIT),'.'...
%         )
%     pause
    
%initial
    plot3(...
        x.p1d1_1a1b1c.x(1:60),...
        x.p1d1_1a1b1c.y(1:60),...
        x.p1d1_1a1b1c.z(1:60),'.',...
        x.p1d1_1a1b1c.x(61:88),...
        x.p1d1_1a1b1c.y(61:88),...
        x.p1d1_1a1b1c.z(61:88),'.',...
        x.p1d1_1a1b1c.x(89:100),...
        x.p1d1_1a1b1c.y(89:100),...
        x.p1d1_1a1b1c.z(89:100),'.'...
        )
    pause
    plot3(...
        x.p1d1_1a1b1c.x(101:101+59),...
        x.p1d1_1a1b1c.y(101:101+59),...
        x.p1d1_1a1b1c.z(101:101+59),'.',...
        x.p1d1_1a1b1c.x(101+60:161+27),...
        x.p1d1_1a1b1c.y(101+60:161+27),...
        x.p1d1_1a1b1c.z(101+60:161+27),'.'...
        )
    pause
    plot3(...
        x.p1d1_1a1b1c.x(189:189+59),...
        x.p1d1_1a1b1c.y(189:189+59),...
        x.p1d1_1a1b1c.z(189:189+59),'.',...
        x.p1d1_1a1b1c.x(249:249+27),...
        x.p1d1_1a1b1c.y(249:249+27),...
        x.p1d1_1a1b1c.z(249:249+27),'.',...
        x.p1d1_1a1b1c.x(277:277+11),...
        x.p1d1_1a1b1c.y(277:277+11),...
        x.p1d1_1a1b1c.z(277:277+11),'.'...
        )
    pause
    plot3(...
        x.p1d1_1a1b1c.x(289:289+59),...
        x.p1d1_1a1b1c.y(289:289+59),...
        x.p1d1_1a1b1c.z(289:289+59),'.',...
        x.p1d1_1a1b1c.x(349:349+27),...
        x.p1d1_1a1b1c.y(349:349+27),...
        x.p1d1_1a1b1c.z(349:349+27),'.'...
        )
    pause
    plot3(...
        x.p1d1_1a1b1c.x(377:388),...
        x.p1d1_1a1b1c.y(377:388),...
        x.p1d1_1a1b1c.z(377:388),'.',...
        x.p1d1_1a1b1c.x(389:400),...
        x.p1d1_1a1b1c.y(389:400),...
        x.p1d1_1a1b1c.z(389:400),'.'...
        )
    pause
    
%--------------------------------------------------------------------------    
%c60
plot3(...
    x.p1d1_1a1b1c.x(1:60),...
    x.p1d1_1a1b1c.y(1:60),...
    x.p1d1_1a1b1c.z(1:60),'.',...
    x.p1d1_1a1b1c.x(101:101+59),...
    x.p1d1_1a1b1c.y(101:101+59),...
    x.p1d1_1a1b1c.z(101:101+59),'.',...
    x.p1d1_1a1b1c.x(189:189+59),...
    x.p1d1_1a1b1c.y(189:189+59),...
    x.p1d1_1a1b1c.z(189:189+59),'.',...
    x.p1d1_1a1b1c.x(289:289+59),...
    x.p1d1_1a1b1c.y(289:289+59),...
    x.p1d1_1a1b1c.z(289:289+59),'.'...
    )
pause

new.CF.x =...
    [x.p1d1_1a1b1c.x(1:60);x.p1d1_1a1b1c.x(101:101+59);...
    x.p1d1_1a1b1c.x(189:189+59);x.p1d1_1a1b1c.x(289:289+59)];
new.CF.y =...
    [x.p1d1_1a1b1c.y(1:60);x.p1d1_1a1b1c.y(101:101+59);...
    x.p1d1_1a1b1c.y(189:189+59);x.p1d1_1a1b1c.y(289:289+59)];
new.CF.z =...
    [x.p1d1_1a1b1c.z(1:60);x.p1d1_1a1b1c.z(101:101+59);...
    x.p1d1_1a1b1c.z(189:189+59);x.p1d1_1a1b1c.z(289:289+59)];
new.CF.type(1:4*60) = type.CF;

plot3(...
    new.CF.x,new.CF.y,new.CF.z,'.')
pause
%--------------------------------------------------------------------------
%pcbm
%--------------------------------------------------------------------------
plot3(...
    x.p1d1_1a1b1c.x(61:88),...
    x.p1d1_1a1b1c.y(61:88),...
    x.p1d1_1a1b1c.z(61:88),'.',...
    x.p1d1_1a1b1c.x(101+60:161+27),...
    x.p1d1_1a1b1c.y(101+60:161+27),...
    x.p1d1_1a1b1c.z(101+60:161+27),'.',...
    x.p1d1_1a1b1c.x(249:249+27),...
    x.p1d1_1a1b1c.y(249:249+27),...
    x.p1d1_1a1b1c.z(249:249+27),'.',...
    x.p1d1_1a1b1c.x(349:349+27),...
    x.p1d1_1a1b1c.y(349:349+27),...
    x.p1d1_1a1b1c.z(349:349+27),'.'...
    )
pause

new.pcbm.x =...
    [x.p1d1_1a1b1c.x(61:88);x.p1d1_1a1b1c.x(101+60:161+27);...
    x.p1d1_1a1b1c.x(249:249+27);x.p1d1_1a1b1c.x(349:349+27)];
new.pcbm.y =...
    [x.p1d1_1a1b1c.y(61:88);x.p1d1_1a1b1c.y(101+60:161+27);...
    x.p1d1_1a1b1c.y(249:249+27);x.p1d1_1a1b1c.y(349:349+27)];
new.pcbm.z =...
    [x.p1d1_1a1b1c.z(61:88);x.p1d1_1a1b1c.z(101+60:161+27);...
    x.p1d1_1a1b1c.z(249:249+27);x.p1d1_1a1b1c.z(349:349+27)];
new.pcbm.m =...
    [x.p1d1_1a1b1c.m(61:88);x.p1d1_1a1b1c.m(101+60:161+27);...
    x.p1d1_1a1b1c.m(249:249+27);x.p1d1_1a1b1c.m(349:349+27)];
plot3(...
    new.pcbm.x,new.pcbm.y,new.pcbm.z,'.')
pause

%check id
pcbm.array(:,1) = x.p1d1_1a1b1c.m(61:88); pcbm.array(:,2) = x.p1d1_1a1b1c.m(101+60:161+27); 
pcbm.array(:,3) = x.p1d1_1a1b1c.m(249:249+27); pcbm.array(:,4) = x.p1d1_1a1b1c.m(349:349+27); 
pcbm.array(:,:)



for iatom = 1:28
plot3(...
    new.CF.x(1:60),new.CF.y(1:60),new.CF.z(1:60),'.',...
    new.pcbm.x(1:28),new.pcbm.y(1:28),new.pcbm.z(1:28),'.',...
    new.pcbm.x(iatom),new.pcbm.y(iatom),new.pcbm.z(iatom),'o')
iatom
new.pcbm.m(iatom)
pause
end

%CT3
new.pcbm.type(1) = type.CT3; new.pcbm.type(28+1) = type.CT3; 
new.pcbm.type(2*28+1) = type.CT3; new.pcbm.type(3*28+1) = type.CT3;
%CA2
new.pcbm.type(2) = type.CA2; new.pcbm.type(28+2) = type.CA2; 
new.pcbm.type(2*28+2) = type.CA2; new.pcbm.type(3*28+2) = type.CA2;
%CA1
new.pcbm.type(3:6) = type.CA1; new.pcbm.type(28+3:28+6) = type.CA1; 
new.pcbm.type(2*28+3:2*28+6) = type.CA1; new.pcbm.type(3*28+3:3*28+6) = type.CA1;
%O
new.pcbm.type(7) = type.O; new.pcbm.type(28+7) = type.O; 
new.pcbm.type(2*28+7) = type.O; new.pcbm.type(3*28+7) = type.O;
%OS
new.pcbm.type(8) = type.OS; new.pcbm.type(28+8) = type.OS; 
new.pcbm.type(2*28+8) = type.OS; new.pcbm.type(3*28+8) = type.OS;
%CA1
new.pcbm.type(9) = type.CA1; new.pcbm.type(28+9) = type.CA1; 
new.pcbm.type(2*28+9) = type.CA1; new.pcbm.type(3*28+9) = type.CA1;
%CT1
new.pcbm.type(10) = type.CT1; new.pcbm.type(28+10) = type.CT1; 
new.pcbm.type(2*28+10) = type.CT1; new.pcbm.type(3*28+10) = type.CT1;
%CT1
new.pcbm.type(11) = type.CT1; new.pcbm.type(28+11) = type.CT1; 
new.pcbm.type(2*28+11) = type.CT1; new.pcbm.type(3*28+11) = type.CT1;
%CT1
new.pcbm.type(12) = type.CT1; new.pcbm.type(28+12) = type.CT1; 
new.pcbm.type(2*28+12) = type.CT1; new.pcbm.type(3*28+12) = type.CT1;
%CT1
new.pcbm.type(13) = type.C; new.pcbm.type(28+13) = type.C; 
new.pcbm.type(2*28+13) = type.C; new.pcbm.type(3*28+13) = type.C;
%CT1
new.pcbm.type(14) = type.CT2; new.pcbm.type(28+14) = type.CT2; 
new.pcbm.type(2*28+14) = type.CT2; new.pcbm.type(3*28+14) = type.CT2;
%HA
new.pcbm.type(15:19) = type.HA; new.pcbm.type(28+15:28+19) = type.HA; 
new.pcbm.type(2*28+15:2*28+19) = type.HA; new.pcbm.type(3*28+15:3*28+19) = type.HA;
%HC
new.pcbm.type(20:28) = type.HC; new.pcbm.type(28+20:28+28) = type.HC; 
new.pcbm.type(2*28+20:2*28+28) = type.HC; new.pcbm.type(3*28+20:3*28+28) = type.HC;

%--------------------------------------------------------------------------
%solvent
%--------------------------------------------------------------------------
plot3(...
    x.p1d1_1a1b1c.x(89:100),...
    x.p1d1_1a1b1c.y(89:100),...
    x.p1d1_1a1b1c.z(89:100),'.',...
    x.p1d1_1a1b1c.x(277:277+11),...
    x.p1d1_1a1b1c.y(277:277+11),...
    x.p1d1_1a1b1c.z(277:277+11),'.',...
    x.p1d1_1a1b1c.x(377:388),...
    x.p1d1_1a1b1c.y(377:388),...
    x.p1d1_1a1b1c.z(377:388),'.',...
    x.p1d1_1a1b1c.x(389:400),...
    x.p1d1_1a1b1c.y(389:400),...
    x.p1d1_1a1b1c.z(389:400),'.'...
    )

new.solvent.x =...
    [x.p1d1_1a1b1c.x(89:100);x.p1d1_1a1b1c.x(277:277+11);...
    x.p1d1_1a1b1c.x(377:388);x.p1d1_1a1b1c.x(389:400)];
new.solvent.y =...
    [x.p1d1_1a1b1c.y(89:100);x.p1d1_1a1b1c.y(277:277+11);...
    x.p1d1_1a1b1c.y(377:388);x.p1d1_1a1b1c.y(389:400)];
new.solvent.z =...
    [x.p1d1_1a1b1c.z(89:100);x.p1d1_1a1b1c.z(277:277+11);...
    x.p1d1_1a1b1c.z(377:388);x.p1d1_1a1b1c.z(389:400)];
new.solvent.m=...
    [x.p1d1_1a1b1c.m(89:100);x.p1d1_1a1b1c.m(277:277+11);...
    x.p1d1_1a1b1c.m(377:388);x.p1d1_1a1b1c.m(389:400)];
% plot3(...
%     new.solvent.x,new.solvent.y,new.solvent.z,'.')
    
for iatom = 1:12
plot3(...
    new.CF.x(1:60),new.CF.y(1:60),new.CF.z(1:60),'.',...
    new.solvent.x(1+12:12+12),new.solvent.y(13:12+12),new.solvent.z(13:12+12),'.',...
    new.solvent.x(iatom+12),new.solvent.y(iatom+12),new.solvent.z(iatom+12),'o')
iatom
new.solvent.m(iatom)
pause
end

new.solvent.type(1) = type.Cl; new.solvent.type(1*12+1:1*12+1) = type.Cl;
new.solvent.type(2*12+1:2*12+1) = type.Cl; new.solvent.type(3*12+1:3*12+1) = type.Cl;

new.solvent.type(2) = type.Cl; new.solvent.type(1*12+2:1*12+2) = type.Cl;
new.solvent.type(2*12+2:2*12+2) = type.Cl; new.solvent.type(3*12+2:3*12+2) = type.Cl;

new.solvent.type(3:8) = type.CA1; new.solvent.type(1*12+3:1*12+8) = type.CA1;
new.solvent.type(2*12+3:2*12+8) = type.CA1; new.solvent.type(3*12+3:3*12+8) = type.CA1;

new.solvent.type(9:12) = type.HA; new.solvent.type(1*12+9:1*12+12) = type.HA;
new.solvent.type(2*12+9:2*12+12) = type.HA; new.solvent.type(3*12+9:3*12+12) = type.HA;

%--------------------------------------------------------------------------
%all
%--------------------------------------------------------------------------

plot3(...
    new.CF.x,new.CF.y,new.CF.z,'.',...
    new.pcbm.x,new.pcbm.y,new.pcbm.z,'.',...
    new.solvent.x,new.solvent.y,new.solvent.z,'.'...
    )
pause

new.x =...
    [new.CF.x;new.pcbm.x;new.solvent.x];
new.y =...
    [new.CF.y;new.pcbm.y;new.solvent.y];
new.z =...
    [new.CF.z;new.pcbm.z;new.solvent.z];
new.type=...
    [new.CF.type new.pcbm.type new.solvent.type];

[I.CF J.CF] = find( new.type==type.CF);
[I.CA1 J.CA1] = find( new.type==type.CA1);
[I.CA2 J.CA2] = find( new.type==type.CA2);
[I.C J.C] = find( new.type==type.C);
[I.CT1 J.CT1] = find( new.type==type.CT1);
[I.CT2 J.CT2] = find( new.type==type.CT2);
[I.CT3 J.CT3] = find( new.type==type.CT3);
[I.O J.O] = find( new.type==type.O);
[I.OS J.OS] = find( new.type==type.OS);
[I.HA J.HA] = find( new.type==type.HA);
[I.HC J.HC] = find( new.type==type.HC);

clf
plot3(...
    new.x(J.CA1),new.y(J.CA1),new.z(J.CA1),'r+',... %new.x(J.CF),new.y(J.CF),new.z(J.CF),'.',...
    new.x(J.CA2),new.y(J.CA2),new.z(J.CA2),'go',...
    new.x(J.C),new.y(J.C),new.z(J.C),'b*',...
    new.x(J.CT1),new.y(J.CT1),new.z(J.CT1),'cx',...
    new.x(J.CT2),new.y(J.CT2),new.z(J.CT2),'ms',...
    new.x(J.CT3),new.y(J.CT3),new.z(J.CT3),'rd',...
    new.x(J.O),new.y(J.O),new.z(J.O),'kv',...
    new.x(J.OS),new.y(J.OS),new.z(J.OS),'^',...
    new.x(J.HA),new.y(J.HA),new.z(J.HA),'>',...
    new.x(J.HC),new.y(J.HC),new.z(J.HC),'<'...
    )
hold on
plot3(...
    new.x(J.HC),new.y(J.HC),new.z(J.HC),'o','MarkerSize',30 ...
    )

new.id = 1:length(new.type);

%output full
output = [length(new.type) length(new.type) 10 10 10];
x =...
    [ new.id' new.type' new.x new.y new.z ];
dlmwrite(...
    '/home/jason/disorder/pcbm/pcbm_pdb/p1d1_1a1b1c.data',...
    output ,'-append','delimiter',' ');
dlmwrite(...
    '/home/jason/disorder/pcbm/pcbm_pdb/p1d1_1a1b1c.data',...
    x ,'-append','delimiter',' ');


%output single
clf
plot3(...
    new.x(1:60),new.y(1:60),new.z(1:60),'.',...
    new.x(241:240+28),new.y(241:240+28),new.z(241:240+28),'.'...
    )
pause
iso.id =...
    [new.id(1:60)';new.id(241:240+28)'];
iso.m =...
    [new.type(1:60)';new.type(241:240+28)'];
iso.z =...
    [new.z(1:60);new.z(241:240+28)];
iso.x =...
    [new.x(1:60);new.x(241:240+28)];
iso.y =...
    [new.y(1:60);new.y(241:240+28)];
iso.x = iso.x +50; iso.y = iso.y +50; iso.z = iso.z +50;

plot3(...
    iso.x,iso.y,iso.z,'.')
pause
output = [length(iso.m) length(iso.m) 100 100 100];
x =...
    [ iso.id iso.m iso.x iso.y iso.z ];
dlmwrite(...
    '/home/jason/disorder/pcbm/pcbm_pdb/isolated/p1d1_1a1b1c.isolated.data',...
    output ,'-append','delimiter',' ');
dlmwrite(...
    '/home/jason/disorder/pcbm/pcbm_pdb/isolated/p1d1_1a1b1c.isolated.data',...
    x ,'-append','delimiter',' ');

%output c60
clf
plot3(...
    new.x(1:60),new.y(1:60),new.z(1:60),'.',...
    new.x(241:240+28),new.y(241:240+28),new.z(241:240+28),'.'...
    )
pause
c60.id =...
    [new.id(1:60)'];
c60.m =...
    [new.type(1:60)'];
c60.z =...
    [new.z(1:60)];
c60.x =...
    [new.x(1:60)];
c60.y =...
    [new.y(1:60)];
c60.x = c60.x +50; c60.y = c60.y +50; c60.z = c60.z +50;

plot3(...
    c60.x,c60.y,c60.z,'.')
pause
output = [length(c60.m) length(c60.m) 100 100 100];
x =...
    [ c60.id c60.m c60.x c60.y c60.z ];
dlmwrite(...
    '/home/jason/disorder/pcbm/pcbm_pdb/isolated/c60.data',...
    output ,'-append','delimiter',' ');
dlmwrite(...
    '/home/jason/disorder/pcbm/pcbm_pdb/isolated/c60.data',...
    x ,'-append','delimiter',' ');

%output c60
clf
plot3(...
    new.x(1:60),new.y(1:60),new.z(1:60),'.',...
    new.x(241:240+28),new.y(241:240+28),new.z(241:240+28),'.'...
    )
pause
pcbm28.id =...
    [new.id(241:240+28)'];
pcbm28.m =...
    [new.type(241:240+28)'];
pcbm28.z =...
    [new.z(241:240+28)];
pcbm28.x =...
    [new.x(241:240+28)];
pcbm28.y =...
    [new.y(241:240+28)];
pcbm28.x = pcbm28.x +50; pcbm28.y = pcbm28.y +50; pcbm28.z = pcbm28.z +50;

plot3(...
    pcbm28.x,pcbm28.y,pcbm28.z,'.')
pause
output = [length(pcbm28.m) length(pcbm28.m) 100 100 100];
x =...
    [ pcbm28.id pcbm28.m pcbm28.x pcbm28.y pcbm28.z ];
dlmwrite(...
    '/home/jason/disorder/pcbm/pcbm_pdb/isolated/pcbm28.data',...
    output ,'-append','delimiter',' ');
dlmwrite(...
    '/home/jason/disorder/pcbm/pcbm_pdb/isolated/pcbm28.data',...
    x ,'-append','delimiter',' ');
 

% param: [400 400 10 10 10]
%                  id: [400x1 double]
%                   m: [400x1 double]
%                   x: [400x1 double]
%                   y: [400x1 double]
%                   z: [400x1 double]
%                 pos: [400x5 double]
%     NUM_ATOMS_UCELL: 400
%           NUM_ATOMS: 400
%           NUM_MODES: 1200
%                  Lx: 10
%                  Ly: 10
%                  Lz: 10
%              VOLUME: 1000
%           NUM_UNITS: 4
%      NUM_ATOMS_UNIT: 100



   
    
    
    
    
    
    
    
    