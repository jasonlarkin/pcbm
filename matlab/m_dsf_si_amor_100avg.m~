clear
lj = m_lj; constant = m_constant;
str_af = '/home/jason/disorder2/si/amor/prepare/8x/nmd/';

AF.eigvec = load(strcat(str_af,'AF_eigvec.dat'));
AF.freq = load(strcat(str_af,'AF_freq.dat'))';
AF.x0 = m_x0_read([str_af 'x0.data']);

nmd.alat = 5.43;

DSF(1).tran =...
    load('/home/jason/disorder2/si/amor/prepare/8x/nmd/DSF_tran_100.mat');
DSF(1).long =...
    load('/home/jason/disorder2/si/amor/prepare/8x/nmd/DSF_long_100.mat');
DSF(2).tran =...
    load('/home/jason/disorder2/si/amor/prepare/8x/nmd/DSF_tran_010.mat');
DSF(2).long =...
    load('/home/jason/disorder2/si/amor/prepare/8x/nmd/DSF_long_010.mat');
DSF(3).tran =...
    load('/home/jason/disorder2/si/amor/prepare/8x/nmd/DSF_tran_001.mat');
DSF(3).long =...
    load('/home/jason/disorder2/si/amor/prepare/8x/nmd/DSF_long_001.mat');

[dosx dosy] = m_dos(AF.freq,20);

subplot(2,1,1),...
semilogy(...
    DSF(1).tran.freq_range,...
    (DSF(1).tran.SL(:,1) + DSF(2).tran.SL(:,1) + DSF(3).tran.SL(:,1))/3,'.',...
    DSF(1).tran.freq_range,...
    (DSF(1).tran.SL(:,3) + DSF(2).tran.SL(:,3) + DSF(3).tran.SL(:,3))/3,'.',...
    DSF(1).tran.freq_range,...
    (DSF(1).tran.SL(:,6) + DSF(2).tran.SL(:,6) + DSF(3).tran.SL(:,6))/3,'.',...
    DSF(1).long.freq_range,...
    (DSF(1).long.SL(:,1) + DSF(2).long.SL(:,1) + DSF(3).long.SL(:,1))/3,'.',...
    DSF(1).long.freq_range,...
    (DSF(1).long.SL(:,3) + DSF(2).long.SL(:,3) + DSF(3).long.SL(:,3))/3,'.',...
    DSF(1).long.freq_range,...
    (DSF(1).long.SL(:,6) + DSF(2).long.SL(:,6) + DSF(3).long.SL(:,6))/3,'.'...
    )
subplot(2,1,2),...
    plot(dosx,dosy)

subplot(2,1,1),...
semilogy(...
    DSF(1).tran.freq_range,...
    (DSF(1).tran.SL(:,1) + DSF(2).tran.SL(:,1) + DSF(3).tran.SL(:,1))/3,'.',...
    DSF(1).tran.freq_range,...
    (DSF(1).tran.SL(:,3) + DSF(2).tran.SL(:,3) + DSF(3).tran.SL(:,3))/3,'.',...
    DSF(1).tran.freq_range,...
    (DSF(1).tran.SL(:,6) + DSF(2).tran.SL(:,6) + DSF(3).tran.SL(:,6))/3,'.',...
    )
subplot(2,1,2),...
    plot(dosx,dosy)

% for ikpt = 1:length(DSF.kpt)
%     AF.kpt(ikpt,:)
% semilogy(...
%     DSF.freq_range,DSF.SL(:,ikpt),...
%     DSF.freq_range,DSF.SL(:,ikpt),...
%     DSF.freq_range,DSF.SL(:,ikpt)...
%     )
% pause
% end
% 
% for ikpt = 1:length(DSF.kpt)
%     AF.kpt(ikpt,:)
% semilogy(...
%     DSF.freq_range,DSF.SL(:,ikpt)...
%     )
% pause
% end

